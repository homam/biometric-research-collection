{"id":"Zfmw","dependencies":[{"name":"/project/home/homam/workspace/node_modules/@supabase/realtime-js/dist/module/RealtimePresence.js.map","includedInParent":true,"mtime":1685174397035},{"name":"/project/home/homam/workspace/node_modules/@supabase/realtime-js/src/RealtimePresence.ts","includedInParent":true,"mtime":1685174397035},{"name":"/project/home/homam/workspace/package.json","includedInParent":true,"mtime":1685174415021},{"name":"/project/home/homam/workspace/node_modules/@supabase/realtime-js/package.json","includedInParent":true,"mtime":1685174397035}],"generated":{"js":"\"use strict\";var e;Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=exports.REALTIME_PRESENCE_LISTEN_EVENTS=void 0,exports.REALTIME_PRESENCE_LISTEN_EVENTS=e,function(e){e.SYNC=\"sync\",e.JOIN=\"join\",e.LEAVE=\"leave\"}(e||(exports.REALTIME_PRESENCE_LISTEN_EVENTS=e={}));class t{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==n?void 0:n.events)||{state:\"presence_state\",diff:\"presence_diff\"};this.channel._on(s.state,{},e=>{const{onJoin:n,onLeave:s,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=t.syncState(this.state,e,n,s),this.pendingDiffs.forEach(e=>{this.state=t.syncDiff(this.state,e,n,s)}),this.pendingDiffs=[],i()}),this.channel._on(s.diff,{},e=>{const{onJoin:n,onLeave:s,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=t.syncDiff(this.state,e,n,s),i())}),this.onJoin((e,t,n)=>{this.channel._trigger(\"presence\",{event:\"join\",key:e,currentPresences:t,newPresences:n})}),this.onLeave((e,t,n)=>{this.channel._trigger(\"presence\",{event:\"leave\",key:e,currentPresences:t,leftPresences:n})}),this.onSync(()=>{this.channel._trigger(\"presence\",{event:\"sync\"})})}static syncState(e,t,n,s){const i=this.cloneDeep(e),r=this.transformState(t),c={},a={};return this.map(i,(e,t)=>{r[e]||(a[e]=t)}),this.map(r,(e,t)=>{const n=i[e];if(n){const s=t.map(e=>e.presence_ref),i=n.map(e=>e.presence_ref),r=t.filter(e=>i.indexOf(e.presence_ref)<0),o=n.filter(e=>s.indexOf(e.presence_ref)<0);r.length>0&&(c[e]=r),o.length>0&&(a[e]=o)}else c[e]=t}),this.syncDiff(i,{joins:c,leaves:a},n,s)}static syncDiff(e,t,n,s){const{joins:i,leaves:r}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return n||(n=(()=>{})),s||(s=(()=>{})),this.map(i,(t,s)=>{var i;const r=null!==(i=e[t])&&void 0!==i?i:[];if(e[t]=this.cloneDeep(s),r.length>0){const n=e[t].map(e=>e.presence_ref),s=r.filter(e=>n.indexOf(e.presence_ref)<0);e[t].unshift(...s)}n(t,r,s)}),this.map(r,(t,n)=>{let i=e[t];if(!i)return;const r=n.map(e=>e.presence_ref);i=i.filter(e=>r.indexOf(e.presence_ref)<0),e[t]=i,s(t,i,n),0===i.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(n=>t(n,e[n]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,n)=>{const s=e[n];return t[n]=\"metas\"in s?s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}exports.default=t;"},"sourceMaps":{"js":{"mappings":[{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":0}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":13}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":12},"generated":{"line":1,"column":17}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":19}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":26}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":41}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":49}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":62}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":63}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":70}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":74}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":82}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":90}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":98}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":135}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":39,"column":1},"generated":{"line":1,"column":137}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":39,"column":1},"generated":{"line":1,"column":145}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":39,"column":1},"generated":{"line":1,"column":177}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":179}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":12},"generated":{"line":1,"column":188}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":36,"column":2},"generated":{"line":1,"column":191}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":36,"column":2},"generated":{"line":1,"column":193}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":36,"column":2},"generated":{"line":1,"column":198}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":37,"column":2},"generated":{"line":1,"column":205}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":37,"column":2},"generated":{"line":1,"column":207}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":37,"column":2},"generated":{"line":1,"column":212}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":38,"column":2},"generated":{"line":1,"column":219}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":38,"column":2},"generated":{"line":1,"column":221}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":38,"column":2},"generated":{"line":1,"column":227}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":0},"generated":{"line":1,"column":235}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":12},"generated":{"line":1,"column":236}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":43},"generated":{"line":1,"column":240}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":43},"generated":{"line":1,"column":248}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":12},"generated":{"line":1,"column":280}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":35,"column":43},"generated":{"line":1,"column":282}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":63,"column":14},"generated":{"line":1,"column":287}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":63,"column":21},"generated":{"line":1,"column":293}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":2},"generated":{"line":1,"column":295}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":21},"generated":{"line":1,"column":307}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":47},"generated":{"line":1,"column":309}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":21},"generated":{"line":1,"column":312}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":21},"generated":{"line":1,"column":317}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":84,"column":21},"generated":{"line":1,"column":325}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":64,"column":2},"generated":{"line":1,"column":327}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":64,"column":2},"generated":{"line":1,"column":332}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":64,"column":33},"generated":{"line":1,"column":338}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":65,"column":2},"generated":{"line":1,"column":341}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":65,"column":2},"generated":{"line":1,"column":346}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":65,"column":36},"generated":{"line":1,"column":359}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":66,"column":2},"generated":{"line":1,"column":362}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":66,"column":2},"generated":{"line":1,"column":367}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":66,"column":27},"generated":{"line":1,"column":375}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":67,"column":2},"generated":{"line":1,"column":380}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":67,"column":2},"generated":{"line":1,"column":385}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":71,"column":6},"generated":{"line":1,"column":392}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":72,"column":4},"generated":{"line":1,"column":393}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":72,"column":12},"generated":{"line":1,"column":400}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":73,"column":4},"generated":{"line":1,"column":407}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":73,"column":13},"generated":{"line":1,"column":415}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":74,"column":4},"generated":{"line":1,"column":422}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":74,"column":12},"generated":{"line":1,"column":429}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":4},"generated":{"line":1,"column":437}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":10},"generated":{"line":1,"column":443}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":19},"generated":{"line":1,"column":446}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":19},"generated":{"line":1,"column":452}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":23},"generated":{"line":1,"column":459}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":19},"generated":{"line":1,"column":461}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":25},"generated":{"line":1,"column":463}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":85,"column":35},"generated":{"line":1,"column":472}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":86,"column":6},"generated":{"line":1,"column":473}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":86,"column":13},"generated":{"line":1,"column":479}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":87,"column":6},"generated":{"line":1,"column":496}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":87,"column":12},"generated":{"line":1,"column":501}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":4},"generated":{"line":1,"column":518}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":9},"generated":{"line":1,"column":523}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":17},"generated":{"line":1,"column":531}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":21},"generated":{"line":1,"column":535}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":28},"generated":{"line":1,"column":537}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":35},"generated":{"line":1,"column":543}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":90,"column":40},"generated":{"line":1,"column":546}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":6},"generated":{"line":1,"column":550}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":12},"generated":{"line":1,"column":556}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":14},"generated":{"line":1,"column":563}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":20},"generated":{"line":1,"column":565}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":22},"generated":{"line":1,"column":573}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":29},"generated":{"line":1,"column":575}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":31},"generated":{"line":1,"column":582}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":42},"generated":{"line":1,"column":585}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":91,"column":47},"generated":{"line":1,"column":590}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":93,"column":6},"generated":{"line":1,"column":597}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":93,"column":11},"generated":{"line":1,"column":602}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":93,"column":21},"generated":{"line":1,"column":610}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":93,"column":26},"generated":{"line":1,"column":615}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":93,"column":34},"generated":{"line":1,"column":623}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":95,"column":6},"generated":{"line":1,"column":634}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":95,"column":11},"generated":{"line":1,"column":639}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":95,"column":19},"generated":{"line":1,"column":645}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":95,"column":36},"generated":{"line":1,"column":647}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":96,"column":8},"generated":{"line":1,"column":657}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":96,"column":13},"generated":{"line":1,"column":662}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":97,"column":8},"generated":{"line":1,"column":668}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":98,"column":8},"generated":{"line":1,"column":670}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":99,"column":8},"generated":{"line":1,"column":672}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":102,"column":6},"generated":{"line":1,"column":675}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":102,"column":11},"generated":{"line":1,"column":680}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":102,"column":24},"generated":{"line":1,"column":693}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":102,"column":33},"generated":{"line":1,"column":701}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":103,"column":8},"generated":{"line":1,"column":705}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":103,"column":13},"generated":{"line":1,"column":710}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":103,"column":21},"generated":{"line":1,"column":716}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":103,"column":38},"generated":{"line":1,"column":718}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":104,"column":10},"generated":{"line":1,"column":727}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":104,"column":15},"generated":{"line":1,"column":732}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":105,"column":10},"generated":{"line":1,"column":738}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":106,"column":10},"generated":{"line":1,"column":740}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":107,"column":10},"generated":{"line":1,"column":742}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":111,"column":6},"generated":{"line":1,"column":747}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":111,"column":11},"generated":{"line":1,"column":752}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":111,"column":26},"generated":{"line":1,"column":765}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":113,"column":6},"generated":{"line":1,"column":768}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":4},"generated":{"line":1,"column":774}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":9},"generated":{"line":1,"column":779}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":17},"generated":{"line":1,"column":787}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":21},"generated":{"line":1,"column":791}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":28},"generated":{"line":1,"column":793}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":34},"generated":{"line":1,"column":798}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":116,"column":39},"generated":{"line":1,"column":801}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":6},"generated":{"line":1,"column":805}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":12},"generated":{"line":1,"column":811}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":14},"generated":{"line":1,"column":818}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":20},"generated":{"line":1,"column":820}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":22},"generated":{"line":1,"column":828}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":29},"generated":{"line":1,"column":830}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":31},"generated":{"line":1,"column":837}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":42},"generated":{"line":1,"column":840}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":117,"column":47},"generated":{"line":1,"column":845}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":119,"column":10},"generated":{"line":1,"column":852}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":119,"column":15},"generated":{"line":1,"column":857}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":120,"column":8},"generated":{"line":1,"column":878}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":120,"column":13},"generated":{"line":1,"column":883}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":120,"column":26},"generated":{"line":1,"column":896}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":120,"column":31},"generated":{"line":1,"column":901}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":122,"column":8},"generated":{"line":1,"column":905}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":122,"column":13},"generated":{"line":1,"column":910}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":122,"column":21},"generated":{"line":1,"column":916}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":122,"column":38},"generated":{"line":1,"column":918}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":123,"column":10},"generated":{"line":1,"column":927}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":123,"column":15},"generated":{"line":1,"column":932}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":124,"column":10},"generated":{"line":1,"column":938}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":125,"column":10},"generated":{"line":1,"column":940}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":126,"column":10},"generated":{"line":1,"column":942}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":129,"column":8},"generated":{"line":1,"column":945}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":4},"generated":{"line":1,"column":952}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":9},"generated":{"line":1,"column":957}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":16},"generated":{"line":1,"column":964}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":17},"generated":{"line":1,"column":965}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":22},"generated":{"line":1,"column":967}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":133,"column":40},"generated":{"line":1,"column":969}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":134,"column":6},"generated":{"line":1,"column":974}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":134,"column":11},"generated":{"line":1,"column":979}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":134,"column":19},"generated":{"line":1,"column":987}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":134,"column":28},"generated":{"line":1,"column":996}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":134,"column":40},"generated":{"line":1,"column":1007}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":135,"column":8},"generated":{"line":1,"column":1008}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":135,"column":15},"generated":{"line":1,"column":1014}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":136,"column":8},"generated":{"line":1,"column":1021}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":136,"column":8},"generated":{"line":1,"column":1025}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":137,"column":8},"generated":{"line":1,"column":1027}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":137,"column":8},"generated":{"line":1,"column":1044}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":138,"column":8},"generated":{"line":1,"column":1046}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":138,"column":8},"generated":{"line":1,"column":1059}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":4},"generated":{"line":1,"column":1065}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":9},"generated":{"line":1,"column":1070}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":17},"generated":{"line":1,"column":1078}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":18},"generated":{"line":1,"column":1079}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":23},"generated":{"line":1,"column":1081}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":142,"column":41},"generated":{"line":1,"column":1083}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":143,"column":6},"generated":{"line":1,"column":1088}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":143,"column":11},"generated":{"line":1,"column":1093}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":143,"column":19},"generated":{"line":1,"column":1101}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":143,"column":28},"generated":{"line":1,"column":1110}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":143,"column":40},"generated":{"line":1,"column":1121}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":144,"column":8},"generated":{"line":1,"column":1122}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":144,"column":15},"generated":{"line":1,"column":1128}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":145,"column":8},"generated":{"line":1,"column":1136}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":145,"column":8},"generated":{"line":1,"column":1140}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":146,"column":8},"generated":{"line":1,"column":1142}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":146,"column":8},"generated":{"line":1,"column":1159}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":147,"column":8},"generated":{"line":1,"column":1161}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":147,"column":8},"generated":{"line":1,"column":1175}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":151,"column":4},"generated":{"line":1,"column":1181}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":151,"column":9},"generated":{"line":1,"column":1186}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":151,"column":16},"generated":{"line":1,"column":1193}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":6},"generated":{"line":1,"column":1198}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":11},"generated":{"line":1,"column":1203}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":19},"generated":{"line":1,"column":1211}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":28},"generated":{"line":1,"column":1220}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":40},"generated":{"line":1,"column":1231}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":42},"generated":{"line":1,"column":1232}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":152,"column":49},"generated":{"line":1,"column":1238}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":166,"column":10},"generated":{"line":1,"column":1249}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":167,"column":4},"generated":{"line":1,"column":1266}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":168,"column":4},"generated":{"line":1,"column":1268}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":169,"column":4},"generated":{"line":1,"column":1270}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":170,"column":4},"generated":{"line":1,"column":1272}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":172,"column":4},"generated":{"line":1,"column":1275}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":172,"column":10},"generated":{"line":1,"column":1281}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":172,"column":18},"generated":{"line":1,"column":1283}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":172,"column":23},"generated":{"line":1,"column":1288}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":172,"column":33},"generated":{"line":1,"column":1298}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":173,"column":10},"generated":{"line":1,"column":1301}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":173,"column":29},"generated":{"line":1,"column":1303}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":173,"column":34},"generated":{"line":1,"column":1308}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":173,"column":49},"generated":{"line":1,"column":1323}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":174,"column":10},"generated":{"line":1,"column":1326}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":174,"column":41},"generated":{"line":1,"column":1328}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":175,"column":10},"generated":{"line":1,"column":1331}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":175,"column":42},"generated":{"line":1,"column":1333}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":4},"generated":{"line":1,"column":1336}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":4},"generated":{"line":1,"column":1343}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":9},"generated":{"line":1,"column":1348}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":13},"generated":{"line":1,"column":1352}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":20},"generated":{"line":1,"column":1354}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":21},"generated":{"line":1,"column":1355}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":177,"column":34},"generated":{"line":1,"column":1357}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":178,"column":11},"generated":{"line":1,"column":1362}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":178,"column":28},"generated":{"line":1,"column":1364}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":179,"column":8},"generated":{"line":1,"column":1369}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":179,"column":15},"generated":{"line":1,"column":1371}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":179,"column":22},"generated":{"line":1,"column":1374}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":4},"generated":{"line":1,"column":1379}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":9},"generated":{"line":1,"column":1384}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":13},"generated":{"line":1,"column":1388}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":31},"generated":{"line":1,"column":1390}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":32},"generated":{"line":1,"column":1391}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":183,"column":37},"generated":{"line":1,"column":1393}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":184,"column":6},"generated":{"line":1,"column":1398}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":184,"column":12},"generated":{"line":1,"column":1404}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":184,"column":43},"generated":{"line":1,"column":1406}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":184,"column":49},"generated":{"line":1,"column":1408}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":186,"column":6},"generated":{"line":1,"column":1411}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":186,"column":10},"generated":{"line":1,"column":1414}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":186,"column":28},"generated":{"line":1,"column":1416}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":187,"column":8},"generated":{"line":1,"column":1417}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":187,"column":14},"generated":{"line":1,"column":1423}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":187,"column":32},"generated":{"line":1,"column":1425}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":187,"column":45},"generated":{"line":1,"column":1427}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":188,"column":11},"generated":{"line":1,"column":1431}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":188,"column":27},"generated":{"line":1,"column":1434}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":188,"column":29},"generated":{"line":1,"column":1436}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":190,"column":14},"generated":{"line":1,"column":1450}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":190,"column":32},"generated":{"line":1,"column":1452}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":190,"column":49},"generated":{"line":1,"column":1454}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":191,"column":11},"generated":{"line":1,"column":1458}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":191,"column":27},"generated":{"line":1,"column":1461}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":191,"column":29},"generated":{"line":1,"column":1463}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":193,"column":14},"generated":{"line":1,"column":1477}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":193,"column":44},"generated":{"line":1,"column":1479}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":193,"column":57},"generated":{"line":1,"column":1481}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":11},"generated":{"line":1,"column":1488}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":27},"generated":{"line":1,"column":1491}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":43},"generated":{"line":1,"column":1493}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":51},"generated":{"line":1,"column":1501}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":53},"generated":{"line":1,"column":1503}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":194,"column":69},"generated":{"line":1,"column":1517}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":196,"column":14},"generated":{"line":1,"column":1520}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":196,"column":42},"generated":{"line":1,"column":1522}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":196,"column":59},"generated":{"line":1,"column":1524}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":11},"generated":{"line":1,"column":1531}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":27},"generated":{"line":1,"column":1534}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":43},"generated":{"line":1,"column":1536}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":51},"generated":{"line":1,"column":1544}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":53},"generated":{"line":1,"column":1546}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":197,"column":69},"generated":{"line":1,"column":1560}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":200,"column":12},"generated":{"line":1,"column":1563}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":200,"column":28},"generated":{"line":1,"column":1565}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":200,"column":37},"generated":{"line":1,"column":1572}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":201,"column":10},"generated":{"line":1,"column":1576}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":201,"column":16},"generated":{"line":1,"column":1578}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":201,"column":23},"generated":{"line":1,"column":1581}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":204,"column":12},"generated":{"line":1,"column":1584}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":204,"column":26},"generated":{"line":1,"column":1586}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":204,"column":35},"generated":{"line":1,"column":1593}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":205,"column":10},"generated":{"line":1,"column":1597}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":205,"column":17},"generated":{"line":1,"column":1599}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":205,"column":24},"generated":{"line":1,"column":1602}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":208,"column":8},"generated":{"line":1,"column":1610}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":208,"column":14},"generated":{"line":1,"column":1612}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":208,"column":21},"generated":{"line":1,"column":1615}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":11},"generated":{"line":1,"column":1619}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":16},"generated":{"line":1,"column":1624}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":25},"generated":{"line":1,"column":1633}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":32},"generated":{"line":1,"column":1635}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":34},"generated":{"line":1,"column":1636}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":34},"generated":{"line":1,"column":1642}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":41},"generated":{"line":1,"column":1644}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":41},"generated":{"line":1,"column":1651}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":51},"generated":{"line":1,"column":1654}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":212,"column":59},"generated":{"line":1,"column":1656}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":225,"column":10},"generated":{"line":1,"column":1659}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":226,"column":4},"generated":{"line":1,"column":1675}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":227,"column":4},"generated":{"line":1,"column":1677}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":228,"column":4},"generated":{"line":1,"column":1679}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":229,"column":4},"generated":{"line":1,"column":1681}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":4},"generated":{"line":1,"column":1684}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":10},"generated":{"line":1,"column":1690}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":12},"generated":{"line":1,"column":1696}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":17},"generated":{"line":1,"column":1698}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":19},"generated":{"line":1,"column":1705}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":231,"column":30},"generated":{"line":1,"column":1708}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":232,"column":6},"generated":{"line":1,"column":1709}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":232,"column":13},"generated":{"line":1,"column":1715}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":232,"column":18},"generated":{"line":1,"column":1720}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":232,"column":33},"generated":{"line":1,"column":1735}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":232,"column":38},"generated":{"line":1,"column":1737}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":233,"column":6},"generated":{"line":1,"column":1744}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":233,"column":14},"generated":{"line":1,"column":1751}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":233,"column":19},"generated":{"line":1,"column":1756}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":233,"column":34},"generated":{"line":1,"column":1771}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":233,"column":39},"generated":{"line":1,"column":1773}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":281,"column":4},"generated":{"line":1,"column":1782}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":236,"column":9},"generated":{"line":1,"column":1789}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":237,"column":6},"generated":{"line":1,"column":1793}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":237,"column":15},"generated":{"line":1,"column":1795}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":240,"column":9},"generated":{"line":1,"column":1805}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":241,"column":6},"generated":{"line":1,"column":1809}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":241,"column":16},"generated":{"line":1,"column":1811}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":4},"generated":{"line":1,"column":1821}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":9},"generated":{"line":1,"column":1826}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":13},"generated":{"line":1,"column":1830}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":20},"generated":{"line":1,"column":1832}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":21},"generated":{"line":1,"column":1833}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":244,"column":26},"generated":{"line":1,"column":1835}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":1840}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":1844}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":6},"generated":{"line":1,"column":1846}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":12},"generated":{"line":1,"column":1852}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":53},"generated":{"line":1,"column":1854}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":43},"generated":{"line":1,"column":1862}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":43},"generated":{"line":1,"column":1864}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":49},"generated":{"line":1,"column":1866}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":53},"generated":{"line":1,"column":1876}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":53},"generated":{"line":1,"column":1880}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":53},"generated":{"line":1,"column":1882}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":245,"column":57},"generated":{"line":1,"column":1884}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":248,"column":6},"generated":{"line":1,"column":1887}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":246,"column":6},"generated":{"line":1,"column":1890}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":246,"column":12},"generated":{"line":1,"column":1892}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":246,"column":19},"generated":{"line":1,"column":1895}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":246,"column":24},"generated":{"line":1,"column":1900}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":246,"column":34},"generated":{"line":1,"column":1910}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":248,"column":10},"generated":{"line":1,"column":1913}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":248,"column":27},"generated":{"line":1,"column":1915}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":248,"column":36},"generated":{"line":1,"column":1922}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":248,"column":39},"generated":{"line":1,"column":1924}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":249,"column":8},"generated":{"line":1,"column":1925}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":249,"column":14},"generated":{"line":1,"column":1931}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":249,"column":35},"generated":{"line":1,"column":1933}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":249,"column":41},"generated":{"line":1,"column":1935}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":249,"column":46},"generated":{"line":1,"column":1938}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":250,"column":11},"generated":{"line":1,"column":1942}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":250,"column":27},"generated":{"line":1,"column":1945}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":250,"column":29},"generated":{"line":1,"column":1947}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":252,"column":14},"generated":{"line":1,"column":1961}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":252,"column":41},"generated":{"line":1,"column":1963}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":252,"column":58},"generated":{"line":1,"column":1965}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":11},"generated":{"line":1,"column":1972}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":27},"generated":{"line":1,"column":1975}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":46},"generated":{"line":1,"column":1977}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":54},"generated":{"line":1,"column":1985}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":56},"generated":{"line":1,"column":1987}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":253,"column":72},"generated":{"line":1,"column":2001}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":256,"column":8},"generated":{"line":1,"column":2004}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":256,"column":14},"generated":{"line":1,"column":2006}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":256,"column":19},"generated":{"line":1,"column":2009}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":256,"column":30},"generated":{"line":1,"column":2020}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":259,"column":6},"generated":{"line":1,"column":2023}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":259,"column":13},"generated":{"line":1,"column":2025}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":259,"column":18},"generated":{"line":1,"column":2027}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":259,"column":36},"generated":{"line":1,"column":2029}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":4},"generated":{"line":1,"column":2034}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":9},"generated":{"line":1,"column":2039}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":13},"generated":{"line":1,"column":2043}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":21},"generated":{"line":1,"column":2045}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":22},"generated":{"line":1,"column":2046}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":262,"column":27},"generated":{"line":1,"column":2048}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":263,"column":6},"generated":{"line":1,"column":2053}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":263,"column":10},"generated":{"line":1,"column":2057}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":263,"column":41},"generated":{"line":1,"column":2059}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":263,"column":47},"generated":{"line":1,"column":2061}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":265,"column":6},"generated":{"line":1,"column":2064}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":265,"column":11},"generated":{"line":1,"column":2068}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":265,"column":29},"generated":{"line":1,"column":2070}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":267,"column":6},"generated":{"line":1,"column":2077}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":267,"column":12},"generated":{"line":1,"column":2083}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":267,"column":35},"generated":{"line":1,"column":2085}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":267,"column":49},"generated":{"line":1,"column":2087}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":268,"column":9},"generated":{"line":1,"column":2091}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":268,"column":25},"generated":{"line":1,"column":2094}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":268,"column":27},"generated":{"line":1,"column":2096}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":270,"column":6},"generated":{"line":1,"column":2110}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":270,"column":25},"generated":{"line":1,"column":2112}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":270,"column":42},"generated":{"line":1,"column":2114}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":9},"generated":{"line":1,"column":2121}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":25},"generated":{"line":1,"column":2124}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":46},"generated":{"line":1,"column":2126}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":54},"generated":{"line":1,"column":2134}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":56},"generated":{"line":1,"column":2136}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":271,"column":72},"generated":{"line":1,"column":2150}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":274,"column":6},"generated":{"line":1,"column":2153}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":274,"column":12},"generated":{"line":1,"column":2155}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":274,"column":19},"generated":{"line":1,"column":2158}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":276,"column":6},"generated":{"line":1,"column":2160}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":276,"column":14},"generated":{"line":1,"column":2162}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":276,"column":19},"generated":{"line":1,"column":2164}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":276,"column":37},"generated":{"line":1,"column":2166}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":278,"column":38},"generated":{"line":1,"column":2169}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":278,"column":10},"generated":{"line":1,"column":2173}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":278,"column":27},"generated":{"line":1,"column":2175}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":278,"column":48},"generated":{"line":1,"column":2190}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":278,"column":54},"generated":{"line":1,"column":2192}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":281,"column":11},"generated":{"line":1,"column":2197}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":285,"column":10},"generated":{"line":1,"column":2199}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":286,"column":4},"generated":{"line":1,"column":2210}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":287,"column":4},"generated":{"line":1,"column":2212}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":4},"generated":{"line":1,"column":2215}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":11},"generated":{"line":1,"column":2222}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":18},"generated":{"line":1,"column":2229}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":38},"generated":{"line":1,"column":2249}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":43},"generated":{"line":1,"column":2252}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":48},"generated":{"line":1,"column":2256}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":56},"generated":{"line":1,"column":2259}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":61},"generated":{"line":1,"column":2261}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":66},"generated":{"line":1,"column":2263}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":289,"column":70},"generated":{"line":1,"column":2265}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":315,"column":10},"generated":{"line":1,"column":2270}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":316,"column":4},"generated":{"line":1,"column":2292}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":4},"generated":{"line":1,"column":2295}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":318,"column":4},"generated":{"line":1,"column":2302}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":318,"column":12},"generated":{"line":1,"column":2304}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":318,"column":17},"generated":{"line":1,"column":2309}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":318,"column":27},"generated":{"line":1,"column":2319}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":11},"generated":{"line":1,"column":2322}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":18},"generated":{"line":1,"column":2329}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":38},"generated":{"line":1,"column":2349}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":45},"generated":{"line":1,"column":2352}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":52},"generated":{"line":1,"column":2359}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":53},"generated":{"line":1,"column":2360}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":320,"column":63},"generated":{"line":1,"column":2362}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":321,"column":6},"generated":{"line":1,"column":2367}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":321,"column":12},"generated":{"line":1,"column":2373}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":321,"column":24},"generated":{"line":1,"column":2375}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":321,"column":30},"generated":{"line":1,"column":2377}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":336,"column":6},"generated":{"line":1,"column":2380}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":8},"generated":{"line":1,"column":2387}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":17},"generated":{"line":1,"column":2389}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":323,"column":10},"generated":{"line":1,"column":2392}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":323,"column":21},"generated":{"line":1,"column":2402}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":24},"generated":{"line":1,"column":2404}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":34},"generated":{"line":1,"column":2406}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":40},"generated":{"line":1,"column":2412}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":324,"column":45},"generated":{"line":1,"column":2416}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":325,"column":10},"generated":{"line":1,"column":2420}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":325,"column":33},"generated":{"line":1,"column":2422}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":325,"column":37},"generated":{"line":1,"column":2435}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":325,"column":55},"generated":{"line":1,"column":2437}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":327,"column":17},"generated":{"line":1,"column":2452}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":327,"column":35},"generated":{"line":1,"column":2454}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":328,"column":17},"generated":{"line":1,"column":2469}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":328,"column":40},"generated":{"line":1,"column":2471}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":330,"column":17},"generated":{"line":1,"column":2484}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":333,"column":24},"generated":{"line":1,"column":2488}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":336,"column":13},"generated":{"line":1,"column":2490}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":337,"column":7},"generated":{"line":1,"column":2493}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":341,"column":10},"generated":{"line":1,"column":2497}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":341,"column":27},"generated":{"line":1,"column":2514}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":4},"generated":{"line":1,"column":2517}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":11},"generated":{"line":1,"column":2524}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":16},"generated":{"line":1,"column":2529}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":22},"generated":{"line":1,"column":2535}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":27},"generated":{"line":1,"column":2540}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":342,"column":37},"generated":{"line":1,"column":2550}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":346,"column":10},"generated":{"line":1,"column":2554}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":346,"column":17},"generated":{"line":1,"column":2561}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":347,"column":4},"generated":{"line":1,"column":2564}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":347,"column":9},"generated":{"line":1,"column":2569}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":347,"column":16},"generated":{"line":1,"column":2576}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":347,"column":25},"generated":{"line":1,"column":2583}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":351,"column":10},"generated":{"line":1,"column":2585}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":351,"column":18},"generated":{"line":1,"column":2593}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":352,"column":4},"generated":{"line":1,"column":2596}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":352,"column":9},"generated":{"line":1,"column":2601}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":352,"column":16},"generated":{"line":1,"column":2608}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":352,"column":26},"generated":{"line":1,"column":2616}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":356,"column":10},"generated":{"line":1,"column":2618}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":356,"column":17},"generated":{"line":1,"column":2625}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":357,"column":4},"generated":{"line":1,"column":2628}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":357,"column":9},"generated":{"line":1,"column":2633}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":357,"column":16},"generated":{"line":1,"column":2640}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":357,"column":25},"generated":{"line":1,"column":2647}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":361,"column":10},"generated":{"line":1,"column":2649}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":4},"generated":{"line":1,"column":2670}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":12},"generated":{"line":1,"column":2677}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":17},"generated":{"line":1,"column":2682}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":28},"generated":{"line":1,"column":2691}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":33},"generated":{"line":1,"column":2696}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":45},"generated":{"line":1,"column":2706}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":50},"generated":{"line":1,"column":2711}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":362,"column":58},"generated":{"line":1,"column":2719}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":2731}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":2739}},{"source":"../../src/RealtimePresence.ts","name":null,"original":{"line":364,"column":1},"generated":{"line":1,"column":2747}}],"sources":{"../../src/RealtimePresence.ts":"/*\n  This file draws heavily from https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/assets/js/phoenix/presence.js\n  License: https://github.com/phoenixframework/phoenix/blob/d344ec0a732ab4ee204215b31de69cf4be72e3bf/LICENSE.md\n*/\n\nimport type {\n  PresenceOpts,\n  PresenceOnJoinCallback,\n  PresenceOnLeaveCallback,\n} from 'phoenix'\nimport type RealtimeChannel from './RealtimeChannel'\n\ntype Presence<T extends { [key: string]: any } = {}> = {\n  presence_ref: string\n} & T\n\nexport type RealtimePresenceState<T extends { [key: string]: any } = {}> = {\n  [key: string]: Presence<T>[]\n}\n\nexport type RealtimePresenceJoinPayload<T extends { [key: string]: any }> = {\n  event: `${REALTIME_PRESENCE_LISTEN_EVENTS.JOIN}`\n  key: string\n  currentPresences: Presence<T>[]\n  newPresences: Presence<T>[]\n}\n\nexport type RealtimePresenceLeavePayload<T extends { [key: string]: any }> = {\n  event: `${REALTIME_PRESENCE_LISTEN_EVENTS.LEAVE}`\n  key: string\n  currentPresences: Presence<T>[]\n  leftPresences: Presence<T>[]\n}\n\nexport enum REALTIME_PRESENCE_LISTEN_EVENTS {\n  SYNC = 'sync',\n  JOIN = 'join',\n  LEAVE = 'leave',\n}\n\ntype PresenceDiff = {\n  joins: RealtimePresenceState\n  leaves: RealtimePresenceState\n}\n\ntype RawPresenceState = {\n  [key: string]: {\n    metas: {\n      phx_ref?: string\n      phx_ref_prev?: string\n      [key: string]: any\n    }[]\n  }\n}\n\ntype RawPresenceDiff = {\n  joins: RawPresenceState\n  leaves: RawPresenceState\n}\n\ntype PresenceChooser<T> = (key: string, presences: Presence[]) => T\n\nexport default class RealtimePresence {\n  state: RealtimePresenceState = {}\n  pendingDiffs: RawPresenceDiff[] = []\n  joinRef: string | null = null\n  caller: {\n    onJoin: PresenceOnJoinCallback\n    onLeave: PresenceOnLeaveCallback\n    onSync: () => void\n  } = {\n    onJoin: () => {},\n    onLeave: () => {},\n    onSync: () => {},\n  }\n\n  /**\n   * Initializes the Presence.\n   *\n   * @param channel - The RealtimeChannel\n   * @param opts - The options,\n   *        for example `{events: {state: 'state', diff: 'diff'}}`\n   */\n  constructor(public channel: RealtimeChannel, opts?: PresenceOpts) {\n    const events = opts?.events || {\n      state: 'presence_state',\n      diff: 'presence_diff',\n    }\n\n    this.channel._on(events.state, {}, (newState: RawPresenceState) => {\n      const { onJoin, onLeave, onSync } = this.caller\n\n      this.joinRef = this.channel._joinRef()\n\n      this.state = RealtimePresence.syncState(\n        this.state,\n        newState,\n        onJoin,\n        onLeave\n      )\n\n      this.pendingDiffs.forEach((diff) => {\n        this.state = RealtimePresence.syncDiff(\n          this.state,\n          diff,\n          onJoin,\n          onLeave\n        )\n      })\n\n      this.pendingDiffs = []\n\n      onSync()\n    })\n\n    this.channel._on(events.diff, {}, (diff: RawPresenceDiff) => {\n      const { onJoin, onLeave, onSync } = this.caller\n\n      if (this.inPendingSyncState()) {\n        this.pendingDiffs.push(diff)\n      } else {\n        this.state = RealtimePresence.syncDiff(\n          this.state,\n          diff,\n          onJoin,\n          onLeave\n        )\n\n        onSync()\n      }\n    })\n\n    this.onJoin((key, currentPresences, newPresences) => {\n      this.channel._trigger('presence', {\n        event: 'join',\n        key,\n        currentPresences,\n        newPresences,\n      })\n    })\n\n    this.onLeave((key, currentPresences, leftPresences) => {\n      this.channel._trigger('presence', {\n        event: 'leave',\n        key,\n        currentPresences,\n        leftPresences,\n      })\n    })\n\n    this.onSync(() => {\n      this.channel._trigger('presence', { event: 'sync' })\n    })\n  }\n\n  /**\n   * Used to sync the list of presences on the server with the\n   * client's state.\n   *\n   * An optional `onJoin` and `onLeave` callback can be provided to\n   * react to changes in the client's local presences across\n   * disconnects and reconnects with the server.\n   *\n   * @internal\n   */\n  private static syncState(\n    currentState: RealtimePresenceState,\n    newState: RawPresenceState | RealtimePresenceState,\n    onJoin: PresenceOnJoinCallback,\n    onLeave: PresenceOnLeaveCallback\n  ): RealtimePresenceState {\n    const state = this.cloneDeep(currentState)\n    const transformedState = this.transformState(newState)\n    const joins: RealtimePresenceState = {}\n    const leaves: RealtimePresenceState = {}\n\n    this.map(state, (key: string, presences: Presence[]) => {\n      if (!transformedState[key]) {\n        leaves[key] = presences\n      }\n    })\n\n    this.map(transformedState, (key, newPresences: Presence[]) => {\n      const currentPresences: Presence[] = state[key]\n\n      if (currentPresences) {\n        const newPresenceRefs = newPresences.map(\n          (m: Presence) => m.presence_ref\n        )\n        const curPresenceRefs = currentPresences.map(\n          (m: Presence) => m.presence_ref\n        )\n        const joinedPresences: Presence[] = newPresences.filter(\n          (m: Presence) => curPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n        const leftPresences: Presence[] = currentPresences.filter(\n          (m: Presence) => newPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n\n        if (joinedPresences.length > 0) {\n          joins[key] = joinedPresences\n        }\n\n        if (leftPresences.length > 0) {\n          leaves[key] = leftPresences\n        }\n      } else {\n        joins[key] = newPresences\n      }\n    })\n\n    return this.syncDiff(state, { joins, leaves }, onJoin, onLeave)\n  }\n\n  /**\n   * Used to sync a diff of presence join and leave events from the\n   * server, as they happen.\n   *\n   * Like `syncState`, `syncDiff` accepts optional `onJoin` and\n   * `onLeave` callbacks to react to a user joining or leaving from a\n   * device.\n   *\n   * @internal\n   */\n  private static syncDiff(\n    state: RealtimePresenceState,\n    diff: RawPresenceDiff | PresenceDiff,\n    onJoin: PresenceOnJoinCallback,\n    onLeave: PresenceOnLeaveCallback\n  ): RealtimePresenceState {\n    const { joins, leaves } = {\n      joins: this.transformState(diff.joins),\n      leaves: this.transformState(diff.leaves),\n    }\n\n    if (!onJoin) {\n      onJoin = () => {}\n    }\n\n    if (!onLeave) {\n      onLeave = () => {}\n    }\n\n    this.map(joins, (key, newPresences: Presence[]) => {\n      const currentPresences: Presence[] = state[key] ?? []\n      state[key] = this.cloneDeep(newPresences)\n\n      if (currentPresences.length > 0) {\n        const joinedPresenceRefs = state[key].map(\n          (m: Presence) => m.presence_ref\n        )\n        const curPresences: Presence[] = currentPresences.filter(\n          (m: Presence) => joinedPresenceRefs.indexOf(m.presence_ref) < 0\n        )\n\n        state[key].unshift(...curPresences)\n      }\n\n      onJoin(key, currentPresences, newPresences)\n    })\n\n    this.map(leaves, (key, leftPresences: Presence[]) => {\n      let currentPresences: Presence[] = state[key]\n\n      if (!currentPresences) return\n\n      const presenceRefsToRemove = leftPresences.map(\n        (m: Presence) => m.presence_ref\n      )\n      currentPresences = currentPresences.filter(\n        (m: Presence) => presenceRefsToRemove.indexOf(m.presence_ref) < 0\n      )\n\n      state[key] = currentPresences\n\n      onLeave(key, currentPresences, leftPresences)\n\n      if (currentPresences.length === 0) delete state[key]\n    })\n\n    return state\n  }\n\n  /** @internal */\n  private static map<T = any>(\n    obj: RealtimePresenceState,\n    func: PresenceChooser<T>\n  ): T[] {\n    return Object.getOwnPropertyNames(obj).map((key) => func(key, obj[key]))\n  }\n\n  /**\n   * Remove 'metas' key\n   * Change 'phx_ref' to 'presence_ref'\n   * Remove 'phx_ref' and 'phx_ref_prev'\n   *\n   * @example\n   * // returns {\n   *  abc123: [\n   *    { presence_ref: '2', user_id: 1 },\n   *    { presence_ref: '3', user_id: 2 }\n   *  ]\n   * }\n   * RealtimePresence.transformState({\n   *  abc123: {\n   *    metas: [\n   *      { phx_ref: '2', phx_ref_prev: '1' user_id: 1 },\n   *      { phx_ref: '3', user_id: 2 }\n   *    ]\n   *  }\n   * })\n   *\n   * @internal\n   */\n  private static transformState(\n    state: RawPresenceState | RealtimePresenceState\n  ): RealtimePresenceState {\n    state = this.cloneDeep(state)\n\n    return Object.getOwnPropertyNames(state).reduce((newState, key) => {\n      const presences = state[key]\n\n      if ('metas' in presences) {\n        newState[key] = presences.metas.map((presence) => {\n          presence['presence_ref'] = presence['phx_ref']\n\n          delete presence['phx_ref']\n          delete presence['phx_ref_prev']\n\n          return presence\n        }) as Presence[]\n      } else {\n        newState[key] = presences\n      }\n\n      return newState\n    }, {} as RealtimePresenceState)\n  }\n\n  /** @internal */\n  private static cloneDeep(obj: { [key: string]: any }) {\n    return JSON.parse(JSON.stringify(obj))\n  }\n\n  /** @internal */\n  private onJoin(callback: PresenceOnJoinCallback): void {\n    this.caller.onJoin = callback\n  }\n\n  /** @internal */\n  private onLeave(callback: PresenceOnLeaveCallback): void {\n    this.caller.onLeave = callback\n  }\n\n  /** @internal */\n  private onSync(callback: () => void): void {\n    this.caller.onSync = callback\n  }\n\n  /** @internal */\n  private inPendingSyncState(): boolean {\n    return !this.joinRef || this.joinRef !== this.channel._joinRef()\n  }\n}\n"},"lineCount":null}},"error":null,"hash":"7cac54e77c8e1da4a6a4da93be98fe9d","cacheData":{"env":{}}}